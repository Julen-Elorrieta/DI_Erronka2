<div class="dashboard-container">
  <h1 class="page-title">{{ 'MENU.HOME' | translate }}</h1>

  <div class="welcome-section">
    <h2>{{ 'MENU.WELCOME' | translate }}, {{ currentUser()?.nombre }}!</h2>
  </div>

  <!-- Admin/God Dashboard -->
  @if (isAdminRole()) {
    <div class="stats-grid">
      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon students">
            <mat-icon>school</mat-icon>
          </div>
          <div class="stat-info">
            <h3 class="stat-value">{{ totalStudents() }}</h3>
            <p class="stat-label">{{ 'STUDENTS' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon teachers">
            <mat-icon>people</mat-icon>
          </div>
          <div class="stat-info">
            <h3 class="stat-value">{{ totalTeachers() }}</h3>
            <p class="stat-label">{{ 'TEACHERS' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon meetings">
            <mat-icon>event</mat-icon>
          </div>
          <div class="stat-info">
            <h3 class="stat-value">{{ todayMeetings() }}</h3>
            <p class="stat-label">{{ 'MEETINGS' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Quick Actions para Admin -->
    <div class="quick-actions">
      <h3>{{ 'COMMON.ACTIONS' | translate }}</h3>
      <div class="actions-grid">
        <a mat-raised-button color="primary" class="users-button" routerLink="/users">
          <mat-icon>people</mat-icon>
          {{ 'USERS' | translate }}
        </a>
        <a mat-raised-button color="accent" routerLink="/meetings">
          <mat-icon>event</mat-icon>
          {{ 'MEETINGS' | translate }}
        </a>
        <a mat-raised-button color="primary" routerLink="/ciclos" class="cycles-button">
          <mat-icon>school</mat-icon>
          {{ 'CICLOS' | translate }}
        </a>
        <a mat-raised-button color="primary" routerLink="/modulos" class="module-button">
          <mat-icon>menu_book</mat-icon>
          {{ 'MODULOS' | translate }}
        </a>
        <a mat-raised-button color="primary" routerLink="/horarios" class="schedule-button">
          <mat-icon>schedule</mat-icon>
          {{ 'HORARIOS' | translate }}
        </a>
        <a
          mat-raised-button
          color="primary"
          routerLink="/matriculaciones"
          class="enrollments-button"
        >
          <mat-icon>assignment</mat-icon>
          {{ 'MATRICULACIONES' | translate }}
        </a>
      </div>
    </div>
  }

  <!-- Teacher Dashboard -->
  @if (isTeacherRole()) {
    <div class="teacher-dashboard">
      <!-- Nire datuak -->
      <mat-card class="profile-summary-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>person</mat-icon>
          <mat-card-title
            >{{ currentUser()?.nombre }} {{ currentUser()?.apellidos }}</mat-card-title
          >
          <mat-card-subtitle>{{ 'ROLE.TEACHER' | translate }}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="teacher-details">
            @if (currentUser()?.email) {
              <div class="detail-item">
                <mat-icon>email</mat-icon>
                <span>{{ currentUser()?.email }}</span>
              </div>
            }
          </div>
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/profile">
            {{ 'MENU.PROFILE' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>

      <!-- Gaurko ordutegia -->
      <mat-card class="schedule-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>schedule</mat-icon>
          <mat-card-title>{{ 'SCHEDULE.TITLE' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (mySchedule().length > 0) {
            <div class="schedule-mini-list">
              @for (slot of mySchedule().slice(0, 6); track slot) {
                <div class="schedule-mini-item">
                  <div class="schedule-time">{{ slot.hour || '--' }}:00</div>
                  <div class="schedule-info">
                    <span class="schedule-subject">{{ getSubjectLabel(slot.subject) }}</span>
                    @if (slot.classroom) {
                      <span class="schedule-classroom">{{ slot.classroom }}</span>
                    }
                  </div>
                </div>
              }
            </div>
          } @else {
            <p class="empty-message">{{ 'SCHEDULE.NO_CLASSES' | translate }}</p>
          }
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/horarios">
            {{ 'COMMON.VIEW_ALL' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>

      <!-- Hurrengo bilerak -->
      <mat-card class="meetings-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>event</mat-icon>
          <mat-card-title>{{ 'MEETING.UPCOMING' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (myMeetings().length > 0) {
            <div class="meetings-mini-list">
              @for (meeting of myMeetings(); track meeting.id_reunion) {
                <div class="meeting-mini-item">
                  <div class="meeting-date">
                    <span class="day">{{ formatDate(meeting.fecha) }}</span>
                    <span class="time">{{ formatTime(meeting.fecha) }}</span>
                  </div>
                  <div class="meeting-info">
                    <span class="meeting-title">{{ meeting.titulo || meeting.asunto }}</span>
                    @if (meeting.aula) {
                      <span class="meeting-place">{{ meeting.aula }}</span>
                    }
                  </div>
                </div>
              }
            </div>
          } @else {
            <p class="empty-message">{{ 'MEETING.NO_UPCOMING' | translate }}</p>
          }
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/meetings">
            {{ 'COMMON.VIEW_ALL' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>

      <!-- Ikasleak ikusi -->
      <mat-card class="info-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>school</mat-icon>
          <mat-card-title>{{ 'MENU.STUDENTS' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ 'DASHBOARD.VIEW_STUDENTS_DESC' | translate }}</p>
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/users">
            {{ 'COMMON.VIEW' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>
    </div>
  }

  <!-- Student Dashboard -->
  @if (isStudentRole()) {
    <div class="student-dashboard">
      <mat-card class="profile-summary-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>person</mat-icon>
          <mat-card-title
            >{{ currentUser()?.nombre }} {{ currentUser()?.apellidos }}</mat-card-title
          >
          <mat-card-subtitle>{{ currentUser()?.email }}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="student-details">
            @if (currentUser()?.direccion) {
              <div class="detail-item">
                <mat-icon>location_on</mat-icon>
                <span>{{ currentUser()?.direccion }}</span>
              </div>
            }
            @if (currentUser()?.telefono1) {
              <div class="detail-item">
                <mat-icon>phone</mat-icon>
                <span>{{ currentUser()?.telefono1 }}</span>
              </div>
            }
          </div>
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/profile">
            {{ 'MENU.PROFILE' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>

      <!-- Nire ordutegia -->
      <mat-card class="schedule-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>schedule</mat-icon>
          <mat-card-title>{{ 'SCHEDULE.TITLE' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (mySchedule().length > 0) {
            <div class="schedule-mini-list">
              @for (slot of mySchedule().slice(0, 6); track slot) {
                <div class="schedule-mini-item">
                  <div class="schedule-time">{{ slot.hour || '--' }}:00</div>
                  <div class="schedule-info">
                    <span class="schedule-subject">{{ getSubjectLabel(slot.subject) }}</span>
                    @if (slot.teacher) {
                      <span class="schedule-teacher">{{ slot.teacher }}</span>
                    }
                    @if (slot.classroom) {
                      <span class="schedule-classroom">{{ slot.classroom }}</span>
                    }
                  </div>
                </div>
              }
            </div>
          } @else {
            <p class="empty-message">{{ 'SCHEDULE.NO_CLASSES' | translate }}</p>
          }
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/profile">
            {{ 'COMMON.VIEW_ALL' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>

      <!-- Hurrengo bilerak -->
      <mat-card class="meetings-card">
        <mat-card-header>
          <mat-icon mat-card-avatar>event</mat-icon>
          <mat-card-title>{{ 'MEETING.UPCOMING' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (myMeetings().length > 0) {
            <div class="meetings-mini-list">
              @for (meeting of myMeetings(); track meeting.id_reunion) {
                <div class="meeting-mini-item">
                  <div class="meeting-date">
                    <span class="day">{{ formatDate(meeting.fecha) }}</span>
                    <span class="time">{{ formatTime(meeting.fecha) }}</span>
                  </div>
                  <div class="meeting-info">
                    <span class="meeting-title">{{ meeting.titulo || meeting.asunto }}</span>
                    @if (meeting.aula) {
                      <span class="meeting-place">{{ meeting.aula }}</span>
                    }
                  </div>
                </div>
              }
            </div>
          } @else {
            <p class="empty-message">{{ 'MEETING.NO_UPCOMING' | translate }}</p>
          }
        </mat-card-content>
        <mat-card-actions>
          <a mat-button color="primary" routerLink="/meetings">
            {{ 'COMMON.VIEW_ALL' | translate }}
            <mat-icon>arrow_forward</mat-icon>
          </a>
        </mat-card-actions>
      </mat-card>
    </div>
  }
</div>
